# ğŸ˜€ Why AI?

AIëŠ” í˜„ëŒ€ ì‚¬íšŒì—ì„œ ê°€ì¥ ê°ê´‘ë°›ëŠ” ê¸°ìˆ ì´ë©°, í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œìì¼ì§€ë¼ë„ ê¸°ë³¸ì ì¸ ì´í•´ì™€ ì‚¬ê³  ë°©ì‹ì„ ë”ë¶ˆì–´ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤ëŠ” ìƒê°ì´ ë“¤ì–´ ì œì‘í•˜ê²Œ ë˜ì—ˆìŒ
ì›¹ ê°œë°œìë„ ë”ì´ìƒì€ AIì˜ ì˜ì—­ì„ ë²—ì–´ë‚  ìˆ˜ ì—†ìœ¼ë©°, ë³µì¡í•œ ê³„ì‚°ê³¼ ë¯¸ë˜ì§€í–¥ì ì¸ ì›¹ ê°œë°œì„ ì§„í–‰í•˜ê¸° ìœ„í•´ AIì— ëŒ€í•œ ì´í•´ëŠ” ë°˜ë“œì‹œ ì´ë£¨ì–´ì ¸ì•¼ í•œë‹¤.
ì˜ˆë¥¼ë“¤ì–´ ì‘ì„±ìì˜ ê²½ìš°, Three.JSë¡œ ìƒì„±ëœ ë°© ë‚´ë¶€ì—ì„œ ì‚¬ìš©ì ìº ì˜ ì‹œê°ì— ë”°ë¼ ì¹´ë©”ë¼ ì‹œì ì„ ì›€ì§ì—¬ì•¼ í•  í•„ìš”ê°€ ìˆì—ˆê¸°ì— AIë¥¼ ë°°ìš°ê²Œ ë˜ì—ˆë‹¤.

## ğŸ˜‚Why JavaScript?

googleì—ì„œ ê°œë°œí•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ, ë³¸ë˜ Pythonì„ í†µí•´ í™œìš©í•˜ê¸°ìœ„í•´ ê°œë°œí•˜ì˜€ìœ¼ë‚˜, JavaScript ì‚¬ìš©ìê°€ ë§ìŒì„ ì¸ì§€í•˜ê³  ì›¹ ê°œë°œì„ í†µí•´ì„œë„ ë‹¤ì–‘í•˜ê²Œ ì‚¬ìš©ë  ìˆ˜ ìˆë„ë¡ ì œì‘ë˜ì—ˆìŒ

1. ë‹¤ì–‘í•œ ë¶„ì•¼ì—ì„œ í•˜ë‚˜ì˜ ì–¸ì–´ë¡œ ì‹¤í–‰ì´ ê°€ëŠ¥í•˜ë‹¤

![image](https://github.com/kwb020312/Begin_Web_Merchine_Learning/assets/46777310/8dd99cd4-8ba4-4b65-a593-4b0809923528)

2. ì‚¬ìš© ê°€ëŠ¥í•œ ì‚¬ìš©ì ìì›ì´ ë§¤ìš° ë§ë‹¤

![image](https://github.com/kwb020312/Begin_Web_Merchine_Learning/assets/46777310/8f88a1ab-4215-46e5-b98d-7cf5aaf35589)

3. NodeJSë¡œ ì„œë²„ê¹Œì§€ êµ¬ì¶•ë  ê²½ìš° Pythonì„ ì‚¬ìš©í•œ ëª¨ë¸ë³´ë‹¤ ì„±ëŠ¥ì´ ìš°ìˆ˜í•˜ë‹¤

![image](https://github.com/kwb020312/Begin_Web_Merchine_Learning/assets/46777310/c1bfe65a-c672-43b2-9b71-d43727a1c0ea)
![image](https://github.com/kwb020312/Begin_Web_Merchine_Learning/assets/46777310/3d9d017b-e8e9-4b3a-91f6-e435cb270ed6)

4. ì‚¬ìš©ì ì ‘ê·¼ì„±ì´ ì¢‹ë‹¤

---

## ğŸ˜€Base Of Tensorflow

ë°ì´í„°ë¥¼ ë‹¤ì°¨ì›ì˜ í˜•íƒœë¡œ í‘œí˜„í•´ì•¼í•  ë•Œ, VanilaJSë¥¼ ì‚¬ìš©í•œë‹¤ë©´ ë‹¤ì°¨ì› ë°°ì—´ ê³„ì‚° ìˆ˜í–‰ì‹œê°„ì´ ë³µì¡í•´ì§ˆìˆ˜ë¡ ë„ˆë¬´ ì˜¤ë˜ ê±¸ë¦¬ê¸° ë•Œë¬¸ì— í•´ë‹¹ ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ ìë£Œí˜•ìœ¼ë¡œ í‘œí˜„í•˜ê³  ê³„ì‚°í•´ì•¼í•œë‹¤.

```javascript
tf.scalar(1) // ì •ìˆ˜ 1(ìŠ¤ì¹¼ë¼)
tf.tensor1d([1, 2, 3]) // 1ì°¨ì› ë°°ì—´
tf.tensor2d(
    [
        [1, 2, 3],
        [4, 5, 6],
        [7, 8, 9]
    ]
) // 2ì°¨ì› ë°°ì—´
...
tf.tensorxd(...) // Nì°¨ì› ë°°ì—´ (ìµœëŒ€ 6ì°¨ì›)
```

---

## ğŸ‘´How Work?

ë¨¸ì‹ ëŸ¬ëŠ¥ì˜ ê²½ìš° AIëŠ” êµ‰ì¥íˆ ê°„ë‹¨í•˜ê²Œ ì •ì˜ë  ìˆ˜ ìˆë‹¤.

ì…ë ¥ê°’ì— ë”°ë¥¸ 0~1ì˜ ì¶œë ¥ì´ë‹¤.

![image](https://github.com/kwb020312/Begin_Web_Machine_Learning/assets/46777310/164b3b80-3117-44dc-bf72-c094b8cb9932)

ìœ„ ì´ë¯¸ì§€ëŠ” ë¨¸ì‹ ëŸ¬ë‹ì´ ì–´ë–»ê²Œ ë™ì‘í•˜ëŠ”ì§€ ë§¤ìš° ê°„ë‹¨í•˜ê²Œ ë³´ì—¬ì£¼ëŠ”ë°

1. ì •ê·œí™”ëœ ê°’(ex. 0.1, 0.2, ...)
2. ëœë¤í•˜ê²Œ ë¶€ì—¬ë˜ëŠ” ê°€ì¤‘ì¹˜(ê²°ê´ê°’ì— ì–¼ë§ˆë‚˜ ì˜í–¥ì„ ë¯¸ì¹˜ëŠ”ê°€?)
3. ëœë¤í•˜ê²Œ ë¶€ì—¬ë˜ëŠ” í¸í–¥
4. í™œì„±í™” í•¨ìˆ˜(ê·¸ë˜í”„)

ì¦‰ 1ì˜ ê°’ì— 2ë¥¼ ê³±í•´ 3ì„ ë”í•œ í›„ í•´ë‹¹ ê°’ì„ í™œì„±í™” í•¨ìˆ˜ ê·¸ë˜í”„ì— ë§ì¶°ë³´ì•˜ì„ ë•Œ í•´ë‹¹ ê·¸ë˜í”„ì— 0~1ì˜ ë²”ìœ„ì— í•´ë‹¹í•˜ëŠ” ê°’ì´ ë°˜í™˜ë˜ëŠ” ê²ƒì´ë©° ì´ë¥¼ í†µí•´ ì˜ˆì¸¡í•˜ê²Œ ë˜ëŠ” ê²ƒì´ë‹¤.

ë§Œì•½ ì˜ˆì¸¡í•œ ê°’ê³¼ ì¶œë ¥ëœ ê°’ì— ì˜¤ì°¨ê°€ ìˆë‹¤ë©´?

í•´ë‹¹ ì˜¤ì°¨ë¥¼ ì¤„ì´ê¸° ìœ„í•´ BackPropagationì„ ì§„í–‰í•˜ë©° weightì™€ biasë¥¼ ì¡°ì •í•˜ì—¬ ë‹¤ì‹œ ì‹¤í–‰í•œë‹¤.

ì´ ë•Œ, í•™ìŠµë¥ ì„ ë„ˆë¬´ ë†’ê²Œ ì„¤ì •í•˜ë©´ ì›í•˜ëŠ” í•´ë¥¼ ì°¾ì§€ ëª»í•  ìˆ˜ ìˆìœ¼ë©°, ë„ˆë¬´ ë‚®ê²Œ ì„¤ì •í•œë‹¤ë©´ ì‹œê°„ì´ ì˜¤ë˜ ê±¸ë¦°ë‹¤.

---

## â†”Normalization

ì •ê·œí™”ëŠ” ì „ì²˜ë¦¬ ê³¼ì •ì—ì„œ ë°˜ë“œì‹œ ì‹¤ì‹œë˜ì–´ì•¼ í•œë‹¤.
Tensorflow.js ì˜ ì „ì²˜ë¦¬ í•¨ìˆ˜ëŠ” ì•„ë˜ì™€ ê°™ì´ ì‘ì„±ëœë‹¤.

```javascript
// ì •ê·œí™”ëœ Tensorë¥¼ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜
function normalize(tensor, min, max) {
  // tf.tidy()ëŠ” ë©”ëª¨ë¦¬ ê´€ë¦¬ë¥¼ ìœ„í•´ ì‚¬ìš©ë˜ë©°, ìƒì„±ëœ í…ì„œë“¤ì€ ì´ ë¸”ë¡ì´ ëë‚œ í›„ì— ìë™ìœ¼ë¡œ í•´ì œ
  const result = tf.tidy(() => {
    const MIN_VALUES = min || tf.min(tensor, 0);
    const MAX_VALUES = max || tf.max(tensor, 0);

    // í…ì„œì—ì„œ ìµœì†Œê°’ì„ ëº€ ê²°ê³¼ë¥¼ ì €ì¥
    const TENSOR_SUBTRACT_MIN_VALUE = tf.sub(tensor, MIN_VALUES);

    // ìµœëŒ“ê°’ - ìµœì†Ÿê°’ì„ í†µí•´ 0~1 ë²”ìœ„ë¥¼ ê²°ì •í•˜ëŠ” 'ë¶„ëª¨' ìƒì„±
    const RANGE_SIZE = tf.sub(MAX_VALUES, MIN_VALUES);
    // 0~1ì‚¬ì‡ê°’ ë°˜í™˜
    const NORMALIZED_VALUES = tf.div(TENSOR_SUBTRACT_MIN_VALUE, RANGE_SIZE);

    return { NORMALIZED_VALUES, MIN_VALUES, MAX_VALUES };
  });

  return result;
}
```

---

## ğŸ˜Create Model & Predict

```javascript
async function train() {
  const LEARNING_RATE = 0.01;

  // ìµœì í™” ë° ì†ì‹¤í•¨ìˆ˜ ì…ë ¥
  model.compile({
    optimizer: tf.train.sgd(LEARNING_RATE),
    loss: "meanSquaredError",
  });

  // í•™ìŠµì§„í–‰ ì •ê·œí™”ëœ ê°’ê³¼ ì¶œë ¥ í…ì„œë¥¼ ì „ë‹¬
  const results = await model.fit(
    FEATURE_RESULTS.NORMALIZED_VALUES,
    OUTPUTS_TENSOR,
    {
      validationSplit: 0.15, //
      shuffle: true,
      batchSize: 64,
      epochs: 10,
    }
  );

  OUTPUTS_TENSOR.dispose();
  FEATURE_RESULTS.NORMALIZED_VALUES.dispose();

  // ê²°ê³¼ í‘œì‹œ, MSEë¥¼ ì†ì‹¤í•¨ìˆ˜ë¡œ ì‚¬ìš©í–ˆê¸° ë•Œë¬¸ì— ì œê³±ê·¼ì„ ì¡°íšŒí•´ì•¼í•¨
  console.log("Average error loss: " + Math.sqrt(results.history.loss.at(-1)));
  console.log(
    "Average validation error loss: " +
      Math.sqrt(results.history.val_loss.at(-1))
  );
  evaluate();
}

function evaluate() {
  tf.tidy(() => {
    // ìƒˆë¡œìš´ ì…ë ¥ê°’ì„ ê¸°ë°˜ìœ¼ë¡œ ì •ê·œí™”
    const newInput = normalize(
      tf.tensor2d([[750, 1]]),
      FEATURE_RESULTS.MIN_VALUES,
      FEATURE_RESULTS.MAX_VALUES
    );

    // ì˜ˆì¸¡ í›„ í‘œì‹œ
    const output = model.predict(newInput.NORMALIZED_VALUES);
    output.print();
  });

  FEATURE_RESULTS.MIN_VALUES.dispose();
  FEATURE_RESULTS.MAX_VALUES.dispose();
  model.dispose();

  console.log(tf.memory().numTensors);
}
```

---

## ğŸ˜Load Model

ìƒì„±ëœ ëª¨ë¸ì„ ë¶ˆëŸ¬ì™€ ì… ì¶œë ¥ì„ í™•ì¸í•´ë³´ì

```javascript
// í‰ë‹¹ ì£¼íƒ ê°€ê²©ì„ ì˜ˆìƒí•˜ëŠ” ì˜ˆì‹œ ëª¨ë¸
const MODEL_PATH =
  "https://storage.googleapis.com/jmstore/TensorFlowJS/EdX/SavedModels/sqftToPropertyPrice/model.json";
let model = undefined;

async function loadModel() {
  // ëª¨ë¸ì€ ë ˆì´ì–´ í˜•ì‹ê³¼ ê·¸ë˜í”„ í˜•ì‹ì´ ìˆìŒ
  // ë ˆì´ì–´: ì‚¬ëŒì´ ì´í•´í•˜ê¸° ì¢‹ìœ¼ë‚˜ ì†ë„ ëŠë¦¼
  // ê·¸ë˜í”„: ì‚¬ëŒì´ ì´í•´í•˜ê¸° ì–´ë ¤ìš°ë‚˜ ì†ë„ ë¹ ë¦„
  model = await tf.loadLayersModel(MODEL_PATH);
  // summaryë¥¼ í†µí•´ ëª¨ë¸ì˜ ì…ì¶œë ¥ êµ¬ì¡°ë¥¼ í™•ì¸
  // input í˜•ì‹ì´ [null, 1] ì´ë©°, ì´ëŠ” Nê°œì˜ ì…ë ¥ì„ í•œë²ˆì— ë°›ì„ ìˆ˜ ìˆê³  ì…ë ¥ ë°°ì—´ìš”ì†Œ ìˆ˜ëŠ” 1ê°œì—¬ì•¼ í•¨ì„ ì˜ë¯¸
  model.summary();

  // ë‹¨ì¼ ì…ë ¥
  const input = tf.tensor2d([[870]]);

  // ë°°ì¹˜ ì…ë ¥
  const inputBatch = tf.tensor2d([[500], [1100], [970]]);

  // ì¶”ë¡ 
  const result = model.predict(input);
  const resultBatch = model.predict(inputBatch);

  // ê²°ê³¼
  result.print();
  resultBatch.print();

  // íê¸°
  input.dispose();
  inputBatch.dispose();
  result.dispose();
  resultBatch.dispose();
  model.dispose();
}

loadModel();
```

---

## ğŸ’¾TFHub

Tensorflowì—ì„œ í™œìš©í•  ìˆ˜ ìˆëŠ” [ì˜¤í”ˆì†ŒìŠ¤ ëª¨ë¸ì„ ê³µìœ í•˜ëŠ” ì‚¬ì´íŠ¸](https://www.kaggle.com/models?tfhub-redirect=true)ì´ë©°, ê° ëª¨ë¸ì€ ì‚¬ìš©ë²•ì„ ëª…ì‹œí•´ì£¼ê¸° ë•Œë¬¸ì— ì‚¬ìš© ì „ ì°¸ê³ í•˜ëŠ”ê²ƒì´ ì¢‹ë‹¤.

## ğŸ’¤Image Classification

`ml5.js`ë¥¼ í†µí•´ `MobileNet`ì— ì €ì¥ëœ 1000ì—¬ê°€ì§€ì˜ Classë¥¼ ë¶„ë¥˜í•´ì£¼ëŠ” Image Classificationì´ ê°€ëŠ¥í•˜ë‹¤.

ì´ë¯¸ì§€ ë° ë™ì˜ìƒì— í•´ë‹¹ ëª¨ë¸ì„ ë¶ˆëŸ¬ì˜¨ í›„ ë‚´ì¥ëœ ì˜ˆì¸¡ ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ê²°ê´ê°’ì„ ë°›ì„ ìˆ˜ ìˆë‹¤.

![image](https://github.com/kwb020312/Begin_Web_Merchine_Learning/assets/46777310/c51730a5-72f9-4d14-8ead-7ddc67b8d107)

---

## ğŸš¼Object Detection

`ml5.js`ì˜ `cocossd`ë¥¼ í™œìš©í•œ Object Detectionì´ ê°€ëŠ¥í•˜ë‹¤.

![image](https://github.com/kwb020312/Begin_Web_Machine_Learning/assets/46777310/131adc56-d048-44ff-acd5-5b7871cafa02)

---

## ğŸƒâ€â™‚ï¸Pose Estimation

```javascript
const MODEL_PATH = `https://tfhub.dev/google/tfjs-model/movenet/singlepose/lightning/4`;
const EXAMPLE_IMG = document.getElementById("exampleImg");
let movenet = undefined;

async function loadAndRunModel() {
  movenet = await tf.loadGraphModel(MODEL_PATH, { fromTFHub: true });

  //   const exampleInputTensor = tf.zeros([1, 192, 192, 3], "int32");
  // ì´ë¯¸ì§€ íƒœê·¸ì˜ í”½ì…€ì„ í…ì„œë¡œ ë³€í™˜
  const imageTensor = tf.browser.fromPixels(EXAMPLE_IMG);
  console.log(imageTensor.shape);

  // ìë¥´ê¸° ì‹œì‘í•  ìœ„ì¹˜
  const cropStartPoint = [15, 170, 0];
  // ìë¥¼ ì´ë¯¸ì§€ í¬ê¸°
  const cropSize = [345, 345, 3];
  // í…ì„œ ìë¥´ê¸°
  const croppedTensor = tf.slice(imageTensor, cropStartPoint, cropSize);

  // ìë¥¸ í…ì„œë¥¼ ê¸°ë°˜í•œ ëª¨ë¸ ì…ë ¥ ì‚¬ì´ì¦ˆ ë§ì¶”ê¸° 192
  const resizedTensor = tf.image
    .resizeBilinear(croppedTensor, [192, 192], true)
    .toInt();

  const tensorOutput = movenet.predict(tf.expandDims(resizedTensor));
  const arrayOutput = await tensorOutput.array();

  console.log(arrayOutput);
}

loadAndRunModel();
```

---

## ğŸ”¢MNIST Number Classification

![image](https://github.com/kwb020312/Begin_Web_Machine_Learning/assets/46777310/c7054cb5-520f-41da-929e-844802c65dd0)

---

## ğŸ¥¼MNIST Fashion Classification

![image](https://github.com/kwb020312/Begin_Web_Machine_Learning/assets/46777310/409f74a2-b6a4-43cc-8d07-874ca28e0909)

---
